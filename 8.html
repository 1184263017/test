<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        // function f1(fn) {
        //     return fn(1,2);
        // }
        // console.log(f1((a,b)=>{
        //     return a+b
        // }));

        // console.log(Object.prototype.toString.call(null));
        // console.log(null instanceof Null);

        // window.onerror = function name(message,url,lin,clo,error) {
        //     console.log(error);
        // }
        // console.log(username);

        // setTimeout(() => {
        //     console.log('1')
        //     setTimeout(() => {
        //         console.log('2')
        //         setTimeout(() => console.log('3'), Math.random() * 100)
        //     }, Math.random() * 100)
        // }, Math.random() * 100)

        const p1 = new Promise((resolve, reject) => {
            resolve()
        })
        // console.log(p1)
        const p3 = p1.then((data)=>{
            console.log(222);
        }).catch(()=>{})
        console.log(p3);


        // const arr = [1,2,3,4,5]
        // const arr1 = arr.filter((v,k,array)=>{
        //     if (v>3) {
        //         return v;
        //     }
        // })
        // console.log(arr1);

        function PromiseS(fun) {
            this.PromiseState = 'pending';
            this.PromiseResult = 'undefined';
            const resolve = (x) => {
                if (this.PromiseState == 'pending') {
                    this.PromiseState = 'fulfilled';
                    this.PromiseResult = x;
                }
            }
            const reject = (x) => {
                if (this.PromiseState == 'pending') {
                    this.PromiseState = 'rejected';
                    this.PromiseResult = x;
                } 
            }

            PromiseS.prototype.then = (t) => {
                if (this.PromiseState == 'fulfilled') {
                    const obj = t(this.PromiseResult)
                }
                return new PromiseS((resolve, reject) => {
                    this.PromiseState
                })
            }
            PromiseS.prototype.finally = () => {
                
            }
            PromiseS.prototype.catch = (c) => {
                console.log(this.PromiseState);
                if (this.PromiseState == 'rejected') {
                    console.log(123);
                    c(this.PromiseResult)
                }
            }

            fun(resolve, reject)
        }
        const p2 = new PromiseS((resolve, reject) => {
            // resolve(789)
            reject(new Error('错误'))
        })
        console.log(p2);
        p2.then((data)=>{
            return 1;
            console.log(data);
        }).catch((e)=>{
            console.log(e);
        })
        // console.log(p2.then().catch());

        
            for (var i = 0; i < 3; i++) {
                setTimeout(() => {

                    console.log(this);
                }, 1);
                console.log(i);
            }
            let x =0;
            for (; x < 3; x++) {
                setTimeout(() => {
                    console.log(x);
                }, 1);
                
            }
    </script>
</body>

</html>